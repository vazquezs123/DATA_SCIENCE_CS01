---
title: "Case Study"
author: "Brady Arendale"
date: "February 20, 2019"
output: html_document
---
```{r}
beers <- read.csv("Beers.csv")
breweries <- read.csv("Breweries.csv")
# Question 1
table(breweries$State)
# Question 2
beer_merged <- merge(beers, breweries, by.x = "Brewery_id", by.y = "Brew_ID")
head(beer_merged)
tail(beer_merged)
# Question 3
for (i in 1:10) {
  print(paste(names(beer_merged[i]), sum(is.na(beer_merged[,i]))))
}
# Question 4
medians <- data.frame(State = "", ABV = 0, IBU = 0)
levels(medians$State) <- levels(beer_merged$State)
for (i in 1:51) {
  medians[i,1] <- levels(beer_merged$State)[i]
  medians[i,2] <- median(beer_merged[beer_merged$State == levels(beer_merged$State)[i], 4], na.rm = TRUE)
  medians[i,3] <- median(beer_merged[beer_merged$State == levels(beer_merged$State)[i], 5], na.rm = TRUE)
}
library(ggplot2)
ggplot(medians) + 
  geom_col(mapping = aes(x = State, y = ABV, fill = State)) + 
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(medians) + 
  geom_col(mapping = aes(x = State, y = IBU, fill = State)) + 
  theme(legend.position = "none", axis.text.x = element_text(angle = 90, hjust = 1))
# Question 6
summary(beer_merged$ABV)
# Question 7
ggplot(beer_merged) + geom_point(mapping = aes(x = ABV, y = IBU, color = State))
# There appears to be a moderate linear relationship
cor(beer_merged$ABV, beer_merged$IBU, use = "complete.obs")
```